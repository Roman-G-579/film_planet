<div class="user-auth-wrapper flex items-center" dir="rtl">
  <p-toast position="bottom-right" />

<!--  TODO: fix link templates-->
  <div class="card flex justify-center" dir="auto">
    <p-menu #menu [model]="profileMenuItems" [popup]="true">
      <ng-template #item let-item>
        <a [routerLink]="item.route"></a>
      </ng-template>
    </p-menu>



    <p-button (click)="menu.toggle($event)" styleClass="!w-[115%]" [rounded]="true" [label]="authService.userData().firstName || authService.userData().username[0]"/>
  </div>

  <a [routerLink]="['/','pages','profile']" class="no-underline">
    <span *ngIf="authService.isLoggedIn()" class="bg-primary hover:bg-primary-300 transition text-primary-contrast rounded-full w-8 h-8 flex items-center justify-center">
      {{authService.userData().username[0]}}
    </span>
  </a>
<!--  <p-button *ngIf="authService.isLoggedIn()" styleClass="!text-[1.4rem]" (click)="authService.logout()" label="Logout" [text]="true" size="large"/>-->
  <p-button *ngIf="!authService.isLoggedIn()" class="signup-link" styleClass="!text-[1.4rem]" [routerLink]="['/','pages','register']" label="Create Account" [text]="true" size="large" />
  <p-button *ngIf="!authService.isLoggedIn()" class="signup-login-link" styleClass="!text-[1.4rem]" (click)="loginPopover.toggle($event)" label="Sign In" [text]="true" size="large" />
  <p-popover #loginPopover>
    <div class="flex flex-col gap-4 w-[25rem]">
      <form [formGroup]="loginForm" (ngSubmit)="login()">
        <div dir="ltr" class="font-medium block">
          <div class="flex justify-end">
            <p-button icon="pi pi-times" [rounded]="true" [text]="true" (click)="loginPopover.hide()"/>
          </div>
          <span class="mb-2">Username</span>
          <input pInputText class="w-[25rem] mb-4" formControlName="username" pAutoFocus="true" />
          <span class="mb-2">Password</span>
          <p-password [toggleMask]="true" fluid styleClass="!mb-4" feedback="false" formControlName="password" />
          <div class="flex justify-end">
            <p-button type="submit" [label]="isLoading() ? '' : 'Login'" [icon]="isLoading() ? 'pi pi-spin pi-spinner' : ''"></p-button>
          </div>
        </div>
      </form>

    </div>
  </p-popover>
</div>
