<main>
  <div class="filter-wrapper flex justify-center">
    <div class="flex bg-neutral-100 dark:bg-neutral-900 w-4/5 justify-center items-center p-4 rounded-lg gap-4 mt-10">
      <p>Filters:</p>

      <p-iftalabel class="w-full md:w-56">
        <p-datePicker
          [(ngModel)]="selectedYear"
          view="year"
          [minDate]="minYear"
          [maxDate]="maxYear"
          dateFormat="yy"
          (onSelect)="filterByYear(selectedYear)"/>
        <label for="dd-year">Year</label>
      </p-iftalabel>

      <p-iftalabel class="w-full md:w-56">
        <p-select [(ngModel)]="selectedGenre" inputId="dd-mediaType" [options]="genres" [showClear]="true" styleClass="w-full" (onChange)="filterByGenre(selectedGenre)" (onClear)="removeGenreFilter()" />
        <label for="dd-mediaType">Genre</label>
      </p-iftalabel>

      <div class="flex flex-col gap-4">
        <div class="flex gap-4">
          <label style="color: lightgrey;">Rating Range {{rangeValues[0]/10}} - {{rangeValues[1]/10}}</label>
          <p-button icon="pi pi-filter" rounded raised></p-button>
        </div>
        <p-slider [(ngModel)]="rangeValues" [range]="true" styleClass="w-56" />
      </div>

      <p-button icon="pi pi-times" (click)="clearFilters()" rounded raised />
    </div>
  </div>
  <div class="top-table-wrapper flex content-center justify-center mt-64">
    <p-table [value]="topTitles()" [tableStyle]="{ 'min-width': '60rem' }">
      <ng-template pTemplate="caption">
        <span class="text-xl font-bold">Top 100 {{resultCriteria()}}</span>

      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>Title</th>
          <th> </th>
          <th>Year</th>
          <th>{{selectedMediaType === MediaType.Film ? 'Directors' : 'Creators'}}</th>
          <th>Genres</th>
          <th>Rating</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.title }}</td>
          <td>
            <img
              [src]="item.image"
              [alt]="item.title"
              class="w-24 rounded"
            />
          </td>
          <td>{{ item.year }}</td>
          <td>{{ selectedMediaType === MediaType.Film ? item.directors : item.creators}}</td>
          <td>{{ item.genres | genreNames }}</td>
          <td>{{ item.rating }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</main>
