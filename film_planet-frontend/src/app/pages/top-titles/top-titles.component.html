<main>
  <div class="filter-wrapper grid grid-cols-12 m-auto max-w-screen-xl gap-4 bg-neutral-100 dark:bg-neutral-900 p-4 rounded-lg mt-6 mb-6 justify-center">
    <div  class="col-span-1">
      <p>Filters:</p>
    </div>

    <div class="year-filter-wrapper col-span-3">
      <p-iftalabel class="w-full md:w-56">
        <p-select [(ngModel)]="selectedYear" inputId="dd-mediaType" [options]="years" [showClear]="true" styleClass="w-full" (onChange)="lib.filterByYear(selectedYear)" (onClear)="lib.removeDateFilter()" />
        <label>Year</label>
      </p-iftalabel>
    </div>

    <div class="genre-filter-wrapper col-span-3 m-auto">
      <p-iftalabel class="w-full md:w-56">
        <p-select [(ngModel)]="selectedGenre" inputId="dd-mediaType" [options]="genres" [showClear]="true" styleClass="w-full" (onChange)="lib.filterByGenre(selectedGenre)" (onClear)="lib.removeGenreFilter()" />
        <label>Genre</label>
      </p-iftalabel>
    </div>

    <div class="rating-filter-wrapper col-span-3 grid grid-rows-2 grid-flow-col m-auto p-1">
      <div class="slider-top-wrapper col-span-2 flex ">
        <!--suppress CssUnresolvedCustomProperty -->
        <label class="w-[13rem] ml-1" style="color: var(--p-form-field-float-label-color);">Rating Range: <b>{{rangeValues[0].toPrecision(2)}}</b> - <b>{{rangeValues[1].toPrecision(2)}}</b></label>
      </div>
      <div class="col-span-2 flex">
        <p-slider [(ngModel)]="rangeValues" [range]="true" [min]="0.0" [max]="10.0" step="0.1" styleClass="w-[8.5vw] mt-2 ml-3" />
      </div>
      <div class="row-span-2 self-center mr-1">
        <p-button icon="pi pi-filter" title="Update List" size="small" raised (onClick)="lib.filterByRating(rangeValues[0],rangeValues[1])"></p-button>
      </div>
    </div>

    <div class="clear-btn-wrapper col-span-2 m-auto">
      <p-button icon="pi pi-times" title="Clear Filters" (click)="lib.clearAllFilters()" rounded raised />
    </div>
  </div>

  <div class="top-table-wrapper lg:max-w-[90%] xl:max-w-[80%] lg:m-auto">

    <p-table [value]="libraryItems()"  [tableStyle]="{ 'min-width': '60rem' }" responsiveLayout="stack" scrollable="true" scrollHeight="85vh">
      <ng-template pTemplate="caption">
        <span class="text-xl font-bold">Top 100 {{titleText()}}</span>

      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>Title</th>
          <th> </th>
          <th>Year</th>
          <th>Genres</th>
          <th>Rating</th>
          <th>Number of Votes</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td><a [routerLink]="item | itemUrl"><p-button styleClass="text-left" [label]="item.title" [link]="true "/></a></td>
          <td>
            <img
              src="{{API_DETAILS.base_url}}{{API_IMG_SIZES.poster_sizes[3]}}/{{item.poster_path}}"
              [alt]="item.title"
              class="w-48 lg:w-24 rounded"
            />
          </td>
          <td>{{ item.release_date || item.first_air_date | date: 'yyyy' }}</td>
          <td>{{ item.genre_ids | genreNames }}</td>
          <td class="text-xl">
            <div class="text-center">
              <b>{{ item.vote_average | number:'1.0-1' }}</b>
            </div>
          </td>
          <td>
            <div class="text-center">
              <span class="inline lg:hidden">(</span>
              {{ item.vote_count }}
              <span class="inline lg:hidden">ratings)</span>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

</main>
